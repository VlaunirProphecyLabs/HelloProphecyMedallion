from pyspark.sql import *
from pyspark.sql.functions import *
from pyspark.sql.types import *
from prophecy.utils import *
from prophecy.libs import typed_lit
from raw_bronze.config.ConfigStore import *
from raw_bronze.udfs import *

def raw_irs_zipcode(spark: SparkSession) -> DataFrame:
    return spark.read\
        .schema(
          StructType([
            StructField("STATEFIPS", StringType(), True), StructField("STATE", StringType(), True), StructField("zipcode", StringType(), True), StructField("agi_stub", StringType(), True), StructField("N1", StringType(), True), StructField("MARS1", StringType(), True), StructField("MARS2", StringType(), True), StructField("MARS4", StringType(), True), StructField("PREP", StringType(), True), StructField("N2", StringType(), True), StructField("NUMDEP", StringType(), True), StructField("A00100", StringType(), True), StructField("N02650", StringType(), True), StructField("A02650", StringType(), True), StructField("N00200", StringType(), True), StructField("A00200", StringType(), True), StructField("N00300", StringType(), True), StructField("A00300", StringType(), True), StructField("N00600", StringType(), True), StructField("A00600", StringType(), True), StructField("N00650", StringType(), True), StructField("A00650", StringType(), True), StructField("N00700", StringType(), True), StructField("A00700", StringType(), True), StructField("N00900", StringType(), True), StructField("A00900", StringType(), True), StructField("N01000", StringType(), True), StructField("A01000", StringType(), True), StructField("N01400", StringType(), True), StructField("A01400", StringType(), True), StructField("N01700", StringType(), True), StructField("A01700", StringType(), True), StructField("SCHF", StringType(), True), StructField("N02300", StringType(), True), StructField("A02300", StringType(), True), StructField("N02500", StringType(), True), StructField("A02500", StringType(), True), StructField("N26270", StringType(), True), StructField("A26270", StringType(), True), StructField("N02900", StringType(), True), StructField("A02900", StringType(), True), StructField("N03220", StringType(), True), StructField("A03220", StringType(), True), StructField("N03300", StringType(), True), StructField("A03300", StringType(), True), StructField("N03270", StringType(), True), StructField("A03270", StringType(), True), StructField("N03150", StringType(), True), StructField("A03150", StringType(), True), StructField("N03210", StringType(), True), StructField("A03210", StringType(), True), StructField("N03230", StringType(), True), StructField("A03230", StringType(), True), StructField("N03240", StringType(), True), StructField("A03240", StringType(), True), StructField("N04470", StringType(), True), StructField("A04470", StringType(), True), StructField("A00101", StringType(), True), StructField("N18425", StringType(), True), StructField("A18425", StringType(), True), StructField("N18450", StringType(), True), StructField("A18450", StringType(), True), StructField("N18500", StringType(), True), StructField("A18500", StringType(), True), StructField("N18300", StringType(), True), StructField("A18300", StringType(), True), StructField("N19300", StringType(), True), StructField("A19300", StringType(), True), StructField("N19700", StringType(), True), StructField("A19700", StringType(), True), StructField("N04800", StringType(), True), StructField("A04800", StringType(), True), StructField("N05800", StringType(), True), StructField("A05800", StringType(), True), StructField("N09600", StringType(), True), StructField("A09600", StringType(), True), StructField("N07100", StringType(), True), StructField("A07100", StringType(), True), StructField("N07300", StringType(), True), StructField("A07300", StringType(), True), StructField("N07180", StringType(), True), StructField("A07180", StringType(), True), StructField("N07230", StringType(), True), StructField("A07230", StringType(), True), StructField("N07240", StringType(), True), StructField("A07240", StringType(), True), StructField("N07220", StringType(), True), StructField("A07220", StringType(), True), StructField("N07260", StringType(), True), StructField("A07260", StringType(), True), StructField("N09400", StringType(), True), StructField("A09400", StringType(), True), StructField("N10600", StringType(), True), StructField("A10600", StringType(), True), StructField("N59660", StringType(), True), StructField("A59660", StringType(), True), StructField("N59720", StringType(), True), StructField("A59720", StringType(), True), StructField("N11070", StringType(), True), StructField("A11070", StringType(), True), StructField("N10960", StringType(), True), StructField("A10960", StringType(), True), StructField("N06500", StringType(), True), StructField("A06500", StringType(), True), StructField("N10300", StringType(), True), StructField("A10300", StringType(), True), StructField("N85330", StringType(), True), StructField("A85330", StringType(), True), StructField("N85300", StringType(), True), StructField("A85300", StringType(), True), StructField("N11901", StringType(), True), StructField("A11901", StringType(), True), StructField("N11902", StringType(), True), StructField("A11902", StringType(), True)
        ])
        )\
        .option("header", True)\
        .option("sep", ",")\
        .csv("dbfs:/databricks-datasets/data.gov/irs_zip_code_data/data-001/2013_soi_zipcode_agi.csv")
