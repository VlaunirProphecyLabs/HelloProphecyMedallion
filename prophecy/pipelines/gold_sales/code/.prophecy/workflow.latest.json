{
  "metainfo" : {
    "migrationVersions" : {
      "gemBuilderVersion" : "v1"
    },
    "functions" : {
      "businessRules" : {
        "rules" : [ ],
        "sharedRules" : [ ]
      }
    },
    "codeGenConfiguration" : {
      "editableConfig" : false,
      "plibVersion" : {
        "mavenVersion" : "8.5.0",
        "pyPiVersion" : "1.9.24"
      }
    },
    "id" : "1",
    "uri" : "pipelines/gold_sales",
    "sourceSuggestions" : [ ],
    "language" : "python",
    "fabricId" : "9664",
    "frontEndLanguage" : "sql",
    "mode" : "batch",
    "udfs" : {
      "language" : "python",
      "udfs" : [ ],
      "functionPackageName" : "scott_demo2_team.helloworld.functions",
      "sharedFunctionPackageNames" : [ "vlaunirprophecyioteam.helloworld.functions", "prophecy.webapp.functions", "prophecy.data_quality.functions", "prophecy.spark_basic.functions", "prophecy.streaming.functions", "prophecy.warehouse.functions", "prophecyteam.prophecyanalyticalfunctionspython.functions" ]
    },
    "udafs" : {
      "language" : "python",
      "code" : ""
    },
    "configuration" : {
      "common" : {
        "type" : "record",
        "fields" : [ {
          "name" : "catalog_name",
          "kind" : {
            "type" : "string",
            "value" : "vlaunir_demos"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "total_by_zip_and_date",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "catalog_name",
              "kind" : {
                "type" : "string",
                "value" : "vlaunir_demos"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        } ]
      },
      "oldCommon" : {
        "type" : "record",
        "fields" : [ ]
      },
      "fabrics" : { },
      "instances" : { },
      "selected" : "default",
      "nonEditable" : [ ],
      "isSubscribedPipelineWithPipelineConfigs" : false
    },
    "sparkConf" : [ ],
    "hadoopConf" : [ ],
    "codeMode" : "sparse",
    "buildSystem" : "maven",
    "externalDependencies" : [ ],
    "dependentProjectExternalDependencies" : [ {
      "projectUID" : "20007",
      "projectName" : "HelloWorld",
      "externalDependencies" : [ {
        "type" : "plibMaven",
        "modifiedAt" : "2024-05-28T19:45:22.250502Z",
        "name" : "plibMaven",
        "enabled" : true,
        "version" : "8.0.25",
        "id" : "668489778",
        "createdAt" : "2024-05-28T19:45:22.250418Z",
        "entity" : "Project"
      }, {
        "type" : "plibPypi",
        "modifiedAt" : "2024-05-28T19:45:22.250558Z",
        "name" : "plibPypi",
        "enabled" : true,
        "version" : "1.9.9",
        "id" : "389499049",
        "createdAt" : "2024-05-28T19:45:22.250536Z",
        "entity" : "Project"
      }, {
        "type" : "coordinates",
        "modifiedAt" : "2024-03-26T15:04:44.161Z",
        "coordinates" : "com.crealytics:spark-excel_2.12:3.5.0_0.20.3",
        "name" : "spark-excel",
        "description" : "com.crealytics:spark-excel_2.12:3.5.0_0.20.3",
        "enabled" : true,
        "id" : "lTRmrXj9GHtw3raRElX4s",
        "createdAt" : "2024-03-26T15:04:44.161Z",
        "entity" : "Project",
        "exclusions" : [ ],
        "editable" : true
      } ]
    }, {
      "projectUID" : "12657",
      "projectName" : "ProphecyWebAppPython",
      "externalDependencies" : [ ]
    }, {
      "projectUID" : "32699",
      "projectName" : "ProphecySparkDataQualityPython",
      "externalDependencies" : [ ]
    }, {
      "projectUID" : "12654",
      "projectName" : "ProphecySparkBasicsPython",
      "externalDependencies" : [ ]
    }, {
      "projectUID" : "12656",
      "projectName" : "ProphecyStreamingPython",
      "externalDependencies" : [ ]
    }, {
      "projectUID" : "12655",
      "projectName" : "ProphecyWarehousePython",
      "externalDependencies" : [ ]
    }, {
      "projectUID" : "16362",
      "projectName" : "ProphecyAnalyticalFunctionsPython",
      "externalDependencies" : [ ]
    } ],
    "isImported" : false,
    "interimMode" : "Full",
    "interimModeEnabled" : true,
    "visualCodeInterimMode" : "Disabled",
    "recordsLimit" : {
      "enabled" : false,
      "value" : 1000
    },
    "topLevelPackage" : "gold_sales",
    "configurationVersion" : "v2"
  },
  "connections" : [ {
    "id" : "EUWSMCykGr0vL9vo9zZuQ",
    "source" : "rxaIaQR5qtYVLzRCX6G2p$$4RQ1lPzoJ4iTYxjh4cFqW",
    "sourcePort" : "0IXqpqy1nhHR5pL5duLgX$$jSWzscyIu532qFaZj_pD4",
    "target" : "tzys2o6Nv0OTQ9dD5uu_4$$l-Vfpcct6dzpSxKM9nLZL",
    "targetPort" : "P2VIaP0u1Ae5oSohEwgHL$$MiiW_boN0cQv80fTjZ9hj"
  }, {
    "id" : "m1JWOjrHzMX9k2MM0YCbB",
    "source" : "CUJmg8TC4ow2LTpkD4xTa$$_i5qUVFTMza3uMVRSyEls",
    "sourcePort" : "WRBU6jOW2-28Bu_9zVFew$$scVkcloeH0qrUHtfeM_Yz",
    "target" : "cmeh9U8XFq8QHeFmwUzw7$$7q6DXJxXUZsDqRK7-C5kX",
    "targetPort" : "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN"
  }, {
    "id" : "Ptqw_mJcKvbp90IglevXQ",
    "source" : "cmeh9U8XFq8QHeFmwUzw7$$7q6DXJxXUZsDqRK7-C5kX",
    "sourcePort" : "MXo6JurnoN6flZNUaHptp$$x5n4R4vwDuL52LdvCVnzS",
    "target" : "rxaIaQR5qtYVLzRCX6G2p$$4RQ1lPzoJ4iTYxjh4cFqW",
    "targetPort" : "p2jAQt4FQ95GTpHzIrNZx$$s0hnqBRZkl_fO5l7h837X"
  }, {
    "id" : "nCxhwJpTC4B0pdWB_MjO1",
    "source" : "cmeh9U8XFq8QHeFmwUzw7$$7q6DXJxXUZsDqRK7-C5kX",
    "sourcePort" : "MXo6JurnoN6flZNUaHptp$$x5n4R4vwDuL52LdvCVnzS",
    "target" : "Z9DnCM3QJiiiVZ6KMpUKy$$1JWV_usPlhESc2BUgo2wH",
    "targetPort" : "chTmzy0asSvb5XqDiWWu2$$3d-uPgGzJ-dKOCn_ZWJ-t"
  }, {
    "id" : "pG1mISC29VQyG4fcS0xxc",
    "source" : "Z9DnCM3QJiiiVZ6KMpUKy$$1JWV_usPlhESc2BUgo2wH",
    "sourcePort" : "wNC4UP7EW6UfJWez6Kfa-$$enRn0T7yIcJBDBFr_Ye11",
    "target" : "fsJ_9X3CSLgpP8S3tpnjV$$zz_aD5JeoVF9Qo-b-MqZk",
    "targetPort" : "_dKalijg_HvoC2Z7qqKIo$$Dya-jEIbEbPX7EPjObOJa"
  } ],
  "processes" : {
    "Z9DnCM3QJiiiVZ6KMpUKy$$1JWV_usPlhESc2BUgo2wH" : {
      "id" : "Z9DnCM3QJiiiVZ6KMpUKy$$1JWV_usPlhESc2BUgo2wH",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "total_by_zip_and_date",
        "slug" : "total_by_zip_and_date",
        "x" : 420,
        "y" : 20,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "Processes order data by removing duplicates based on order ID, zipcode, order date, and amount. It then aggregates the data to calculate total and average amounts, along with order counts for each zipcode and date. Finally, the results are sorted by order date and zipcode.",
        "autoUpdateComment" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "chTmzy0asSvb5XqDiWWu2$$3d-uPgGzJ-dKOCn_ZWJ-t",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "order_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "customer_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "order_status",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Order status",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "order_category",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Order category",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "order_date",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "amount",
              "type" : "float",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "first_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer first name",
                "mappings" : [ ],
                "tags" : [ {
                  "type" : "user",
                  "name" : "pii"
                } ]
              }
            }, {
              "name" : "last_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer last name",
                "mappings" : [ ],
                "tags" : [ {
                  "type" : "user",
                  "name" : "pii"
                } ]
              }
            }, {
              "name" : "phone",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer phone number",
                "mappings" : [ ],
                "tags" : [ {
                  "type" : "user",
                  "name" : "pii"
                } ]
              }
            }, {
              "name" : "email",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer Email",
                "mappings" : [ ],
                "tags" : [ {
                  "type" : "user",
                  "name" : "pii"
                } ]
              }
            }, {
              "name" : "country_code",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer country code",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account_open_date",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account_flags",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer account flags",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Unique identifier for the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Name of the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account_owner",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The person who owns the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "phone_number",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The contact phone number associated with the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "billing_address",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Physical address for billing purposes",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "billing_postal_code",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Postal code of the billing address",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "billing_city",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "City of the billing address",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "billing_state",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The state associated with the billing address of the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "billing_email",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Email address associated with the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account_type",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The type or category of the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "industry",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The industry to which the account belongs",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "annual_revenue",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The annual revenue of the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "number_of_employees",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The number of employees associated with the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "last_activity_date",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The date of the most recent activity related to the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "created_date",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The date when the account was created",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "website",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The website associated with the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "lead_source",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The source from which the lead was generated",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "status",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The current status of the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rating",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The rating assigned to the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "description",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "A description or summary of the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "last_modified_by",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The user who last modified the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "last_modified_date",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The date when the account was last modified",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "zipcode",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The ZIP code",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "state",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "high_income_percent",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "high_income_returns",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "low_income_returns",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "all_returns",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "is_high_income",
              "type" : "boolean",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "fullName",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "wNC4UP7EW6UfJWez6Kfa-$$enRn0T7yIcJBDBFr_Ye11",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : { },
      "connections" : [ {
        "id" : "nNHEaRUNy89SnxMMm0u6e$$-mznfAvOIBQViCaGDLFr5",
        "source" : "L5pc-eqdwtyTELkfSP_Db$$m6L2oF5lTnjYGBbTHzBIB",
        "sourcePort" : "ulT2FJ2Fug1Okqy-6vwmE$$CbMe6Hp9gNJrv8FI3igxG",
        "target" : "CCdS0rXltkp7g_udaQXQ4$$bj3i7a-ojc2Tti2iN53pU",
        "targetPort" : "3ulCjlNOkS_alOfJhq6QI$$-Ox7j5FrMFazxlAQk04-m"
      }, {
        "id" : "_oRhzHxv1oipxqEsFPk-K$$j2w9MgCXxOTIpMQtLaRg7",
        "source" : "CCdS0rXltkp7g_udaQXQ4$$bj3i7a-ojc2Tti2iN53pU",
        "sourcePort" : "oQeYRAZFurCHPn5NOSKd8$$hwd9qy4uEmFJmeSv3HocX",
        "target" : "Z9DnCM3QJiiiVZ6KMpUKy$$1JWV_usPlhESc2BUgo2wH",
        "targetPort" : "wNC4UP7EW6UfJWez6Kfa-$$enRn0T7yIcJBDBFr_Ye11"
      }, {
        "id" : "sqt4G7LoT0zO6dzDRP9wl$$BT4ALEg86yWY6PjCiKhJi",
        "source" : "Gxwrum9VM-EG2dOyPwWgM$$Rq2sddwml2gWhTbbiBv3X",
        "sourcePort" : "gvMFQmrN7JhQ-GiK3bxCW$$lfd5hs8C-fuUGdC2-WMCP",
        "target" : "L5pc-eqdwtyTELkfSP_Db$$m6L2oF5lTnjYGBbTHzBIB",
        "targetPort" : "97RXLmrAv6ye9XZENUZEq$$9VT2PijShjMNNlvt-3uOx"
      }, {
        "id" : "jAYYLI14tL3SvOYnRhJfZ",
        "source" : "Z9DnCM3QJiiiVZ6KMpUKy$$1JWV_usPlhESc2BUgo2wH",
        "sourcePort" : "chTmzy0asSvb5XqDiWWu2$$3d-uPgGzJ-dKOCn_ZWJ-t",
        "target" : "Gxwrum9VM-EG2dOyPwWgM$$Rq2sddwml2gWhTbbiBv3X",
        "targetPort" : "75gKWW7EOU4wBcSrTcv8N$$QvA2VlpyK-0rKmx_hv__c"
      } ],
      "processes" : {
        "L5pc-eqdwtyTELkfSP_Db$$m6L2oF5lTnjYGBbTHzBIB" : {
          "id" : "L5pc-eqdwtyTELkfSP_Db$$m6L2oF5lTnjYGBbTHzBIB",
          "component" : "Aggregate",
          "metadata" : {
            "label" : "TotalByZipCodeAndDate",
            "slug" : "TotalByZipCodeAndDate",
            "x" : 820,
            "y" : 320,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "97RXLmrAv6ye9XZENUZEq$$9VT2PijShjMNNlvt-3uOx",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "order_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customer_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "order_status",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Order status",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "order_category",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Order category",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "order_date",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "amount",
                  "type" : "float",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "first_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Customer first name",
                    "mappings" : [ ],
                    "tags" : [ {
                      "type" : "user",
                      "name" : "pii"
                    } ]
                  }
                }, {
                  "name" : "last_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Customer last name",
                    "mappings" : [ ],
                    "tags" : [ {
                      "type" : "user",
                      "name" : "pii"
                    } ]
                  }
                }, {
                  "name" : "phone",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Customer phone number",
                    "mappings" : [ ],
                    "tags" : [ {
                      "type" : "user",
                      "name" : "pii"
                    } ]
                  }
                }, {
                  "name" : "email",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Customer Email",
                    "mappings" : [ ],
                    "tags" : [ {
                      "type" : "user",
                      "name" : "pii"
                    } ]
                  }
                }, {
                  "name" : "country_code",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Customer country code",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "account_open_date",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "account_flags",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Customer account flags",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "account_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Unique identifier for the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "account_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Name of the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "account_owner",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The person who owns the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "phone_number",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The contact phone number associated with the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "billing_address",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Physical address for billing purposes",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "billing_postal_code",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Postal code of the billing address",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "billing_city",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "City of the billing address",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "billing_state",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The state associated with the billing address of the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "billing_email",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Email address associated with the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "account_type",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The type or category of the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "industry",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The industry to which the account belongs",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "annual_revenue",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The annual revenue of the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "number_of_employees",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The number of employees associated with the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "last_activity_date",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The date of the most recent activity related to the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "created_date",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The date when the account was created",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "website",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The website associated with the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lead_source",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The source from which the lead was generated",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "status",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The current status of the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rating",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The rating assigned to the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "description",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "A description or summary of the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "last_modified_by",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The user who last modified the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "last_modified_date",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The date when the account was last modified",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "zipcode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The ZIP code",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "state",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "high_income_percent",
                  "type" : "double",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "high_income_returns",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "low_income_returns",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "all_returns",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_high_income",
                  "type" : "boolean",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "fullName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "ulT2FJ2Fug1Okqy-6vwmE$$CbMe6Hp9gNJrv8FI3igxG",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "allIns" : false,
            "doPivot" : false,
            "aggregate" : [ {
              "target" : "total_amount",
              "expression" : {
                "format" : "sql",
                "expression" : "sum(amount)"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "avg_amount",
              "expression" : {
                "format" : "sql",
                "expression" : "avg(amount)"
              },
              "description" : "",
              "_row_id" : "c_1508"
            }, {
              "target" : "order_count",
              "expression" : {
                "format" : "sql",
                "expression" : "count(order_id)"
              },
              "description" : "",
              "_row_id" : "c_1555"
            } ],
            "allowSelection" : true,
            "pivotColumn" : null,
            "pivotValues" : [ ],
            "activeTab" : "groupBy",
            "columnsSelector" : [ "97RXLmrAv6ye9XZENUZEq$$9VT2PijShjMNNlvt-3uOx##zipcode", "97RXLmrAv6ye9XZENUZEq$$9VT2PijShjMNNlvt-3uOx##amount", "97RXLmrAv6ye9XZENUZEq$$9VT2PijShjMNNlvt-3uOx##order_date", "97RXLmrAv6ye9XZENUZEq$$9VT2PijShjMNNlvt-3uOx##order_id" ],
            "groupBy" : [ {
              "target" : "zipcode",
              "expression" : {
                "format" : "sql",
                "expression" : "zipcode"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "order_date",
              "expression" : {
                "format" : "sql",
                "expression" : "order_date"
              },
              "description" : "",
              "_row_id" : null
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.35&projectSubscriptionProjectId=12654&path=gems/Aggregate",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "CCdS0rXltkp7g_udaQXQ4$$bj3i7a-ojc2Tti2iN53pU" : {
          "id" : "CCdS0rXltkp7g_udaQXQ4$$bj3i7a-ojc2Tti2iN53pU",
          "component" : "OrderBy",
          "metadata" : {
            "label" : "SortByDateAndZip",
            "slug" : "SortByDateAndZip",
            "x" : 1000,
            "y" : 320,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "3ulCjlNOkS_alOfJhq6QI$$-Ox7j5FrMFazxlAQk04-m",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "zipcode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The ZIP code",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "order_date",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "total_amount",
                  "type" : "double",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "avg_amount",
                  "type" : "double",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "order_count",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "oQeYRAZFurCHPn5NOSKd8$$hwd9qy4uEmFJmeSv3HocX",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ "3ulCjlNOkS_alOfJhq6QI$$-Ox7j5FrMFazxlAQk04-m##order_date", "3ulCjlNOkS_alOfJhq6QI$$-Ox7j5FrMFazxlAQk04-m##zipcode" ],
            "orders" : [ {
              "expression" : {
                "format" : "sql",
                "expression" : "order_date"
              },
              "sortType" : "asc"
            }, {
              "expression" : {
                "format" : "sql",
                "expression" : "zipcode"
              },
              "sortType" : "asc"
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.35&projectSubscriptionProjectId=12654&path=gems/OrderBy",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "Gxwrum9VM-EG2dOyPwWgM$$Rq2sddwml2gWhTbbiBv3X" : {
          "id" : "Gxwrum9VM-EG2dOyPwWgM$$Rq2sddwml2gWhTbbiBv3X",
          "component" : "Deduplicate",
          "metadata" : {
            "label" : "deduplicate_by_order_id_zipcode_order_date_amount",
            "slug" : "deduplicate_by_order_id_zipcode_order_date_amount",
            "x" : 640,
            "y" : 320,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "comment" : "Removes duplicate records based on order ID, zipcode, order date, and amount.",
            "autoUpdateComment" : true
          },
          "ports" : {
            "inputs" : [ {
              "id" : "75gKWW7EOU4wBcSrTcv8N$$QvA2VlpyK-0rKmx_hv__c",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "order_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customer_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "order_status",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Order status",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "order_category",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Order category",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "order_date",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "amount",
                  "type" : "float",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "first_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Customer first name",
                    "mappings" : [ ],
                    "tags" : [ {
                      "type" : "user",
                      "name" : "pii"
                    } ]
                  }
                }, {
                  "name" : "last_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Customer last name",
                    "mappings" : [ ],
                    "tags" : [ {
                      "type" : "user",
                      "name" : "pii"
                    } ]
                  }
                }, {
                  "name" : "phone",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Customer phone number",
                    "mappings" : [ ],
                    "tags" : [ {
                      "type" : "user",
                      "name" : "pii"
                    } ]
                  }
                }, {
                  "name" : "email",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Customer Email",
                    "mappings" : [ ],
                    "tags" : [ {
                      "type" : "user",
                      "name" : "pii"
                    } ]
                  }
                }, {
                  "name" : "country_code",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Customer country code",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "account_open_date",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "account_flags",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Customer account flags",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "account_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Unique identifier for the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "account_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Name of the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "account_owner",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The person who owns the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "phone_number",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The contact phone number associated with the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "billing_address",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Physical address for billing purposes",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "billing_postal_code",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Postal code of the billing address",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "billing_city",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "City of the billing address",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "billing_state",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The state associated with the billing address of the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "billing_email",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Email address associated with the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "account_type",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The type or category of the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "industry",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The industry to which the account belongs",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "annual_revenue",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The annual revenue of the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "number_of_employees",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The number of employees associated with the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "last_activity_date",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The date of the most recent activity related to the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "created_date",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The date when the account was created",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "website",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The website associated with the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "lead_source",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The source from which the lead was generated",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "status",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The current status of the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rating",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The rating assigned to the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "description",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "A description or summary of the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "last_modified_by",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The user who last modified the account",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "last_modified_date",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The date when the account was last modified",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "zipcode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The ZIP code",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "state",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "high_income_percent",
                  "type" : "double",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "high_income_returns",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "low_income_returns",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "all_returns",
                  "type" : "long",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_high_income",
                  "type" : "boolean",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "fullName",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "gvMFQmrN7JhQ-GiK3bxCW$$lfd5hs8C-fuUGdC2-WMCP",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "dedupColumns" : [ {
              "colName" : "order_id"
            }, {
              "colName" : "zipcode"
            }, {
              "colName" : "order_date"
            }, {
              "colName" : "amount"
            } ],
            "dedupType" : "any",
            "columnsSelector" : [ "75gKWW7EOU4wBcSrTcv8N$$QvA2VlpyK-0rKmx_hv__c##zipcode", "75gKWW7EOU4wBcSrTcv8N$$QvA2VlpyK-0rKmx_hv__c##order_date", "75gKWW7EOU4wBcSrTcv8N$$QvA2VlpyK-0rKmx_hv__c##amount", "75gKWW7EOU4wBcSrTcv8N$$QvA2VlpyK-0rKmx_hv__c##order_id" ],
            "orders" : [ ],
            "useOrderBy" : false
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.35&projectSubscriptionProjectId=12654&path=gems/Deduplicate",
            "projectName" : "ProphecySparkBasicsPython"
          }
        }
      }
    },
    "cmeh9U8XFq8QHeFmwUzw7$$7q6DXJxXUZsDqRK7-C5kX" : {
      "id" : "cmeh9U8XFq8QHeFmwUzw7$$7q6DXJxXUZsDqRK7-C5kX",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Cleanup",
        "slug" : "Cleanup",
        "x" : 220,
        "y" : 120,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "Streamlines customer order data by selecting relevant fields and creating a full name for better clarity and reporting.",
        "autoUpdateComment" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "customer_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "first_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer first name",
                "mappings" : [ ],
                "tags" : [ {
                  "type" : "user",
                  "name" : "pii"
                } ]
              }
            }, {
              "name" : "last_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer last name",
                "mappings" : [ ],
                "tags" : [ {
                  "type" : "user",
                  "name" : "pii"
                } ]
              }
            }, {
              "name" : "phone",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer phone number",
                "mappings" : [ ],
                "tags" : [ {
                  "type" : "user",
                  "name" : "pii"
                } ]
              }
            }, {
              "name" : "email",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer Email",
                "mappings" : [ ],
                "tags" : [ {
                  "type" : "user",
                  "name" : "pii"
                } ]
              }
            }, {
              "name" : "country_code",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer country code",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account_open_date",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account_flags",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer account flags",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Unique identifier for the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Name of the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account_owner",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The person who owns the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "phone_number",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The contact phone number associated with the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "billing_address",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Physical address for billing purposes",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "billing_postal_code",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Postal code of the billing address",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "billing_city",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "City of the billing address",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "billing_state",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The state associated with the billing address of the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "billing_email",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Email address associated with the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account_type",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The type or category of the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "industry",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The industry to which the account belongs",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "annual_revenue",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The annual revenue of the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "number_of_employees",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The number of employees associated with the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "last_activity_date",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The date of the most recent activity related to the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "created_date",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The date when the account was created",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "website",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The website associated with the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "lead_source",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The source from which the lead was generated",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "status",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The current status of the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rating",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The rating assigned to the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "description",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "A description or summary of the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "last_modified_by",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The user who last modified the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "last_modified_date",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The date when the account was last modified",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "zipcode",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The ZIP code",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "state",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "high_income_percent",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "high_income_returns",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "low_income_returns",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "all_returns",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "is_high_income",
              "type" : "boolean",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "order_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "order_status",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Order status",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "order_category",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Order category",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "order_date",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "amount",
              "type" : "float",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "item_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Name of the item ordered",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "item_company",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The company that manufactures or supplies the item",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "quantity",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The number of items ordered",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "unit_price",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Price per unit of the ordered item",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "shipping_address",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The address where the order will be shipped",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "shipping_city",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "City where the order is being shipped",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "shipping_state",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The state where the order is being shipped",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "shipping_postal_code",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Postal code for the shipping address of the order",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "payment_method",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The method used for payment in the order",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "payment_status",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Current status of the payment for the order",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "shipping_status",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Current status of the shipping process for the order",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "notes",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Additional comments or special instructions related to the order",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "MXo6JurnoN6flZNUaHptp$$x5n4R4vwDuL52LdvCVnzS",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "importLanguage" : "python",
        "expressions" : [ {
          "target" : "order_id",
          "expression" : {
            "format" : "sql",
            "expression" : "order_id"
          },
          "description" : ""
        }, {
          "target" : "customer_id",
          "expression" : {
            "format" : "sql",
            "expression" : "customer_id"
          },
          "description" : ""
        }, {
          "target" : "order_status",
          "expression" : {
            "format" : "sql",
            "expression" : "order_status"
          },
          "description" : ""
        }, {
          "target" : "order_category",
          "expression" : {
            "format" : "sql",
            "expression" : "order_category"
          },
          "description" : ""
        }, {
          "target" : "order_date",
          "expression" : {
            "format" : "sql",
            "expression" : "order_date"
          },
          "description" : ""
        }, {
          "target" : "amount",
          "expression" : {
            "format" : "sql",
            "expression" : "amount"
          },
          "description" : ""
        }, {
          "target" : "first_name",
          "expression" : {
            "format" : "sql",
            "expression" : "first_name"
          },
          "description" : ""
        }, {
          "target" : "last_name",
          "expression" : {
            "format" : "sql",
            "expression" : "last_name"
          },
          "description" : ""
        }, {
          "target" : "phone",
          "expression" : {
            "format" : "sql",
            "expression" : "phone"
          },
          "description" : ""
        }, {
          "target" : "email",
          "expression" : {
            "format" : "sql",
            "expression" : "email"
          },
          "description" : ""
        }, {
          "target" : "country_code",
          "expression" : {
            "format" : "sql",
            "expression" : "country_code"
          },
          "description" : ""
        }, {
          "target" : "account_open_date",
          "expression" : {
            "format" : "sql",
            "expression" : "account_open_date"
          },
          "description" : ""
        }, {
          "target" : "account_flags",
          "expression" : {
            "format" : "sql",
            "expression" : "account_flags"
          },
          "description" : ""
        }, {
          "target" : "account_id",
          "expression" : {
            "format" : "sql",
            "expression" : "account_id"
          },
          "description" : ""
        }, {
          "target" : "account_name",
          "expression" : {
            "format" : "sql",
            "expression" : "account_name"
          },
          "description" : ""
        }, {
          "target" : "account_owner",
          "expression" : {
            "format" : "sql",
            "expression" : "account_owner"
          },
          "description" : ""
        }, {
          "target" : "phone_number",
          "expression" : {
            "format" : "sql",
            "expression" : "phone_number"
          },
          "description" : ""
        }, {
          "target" : "billing_address",
          "expression" : {
            "format" : "sql",
            "expression" : "billing_address"
          },
          "description" : ""
        }, {
          "target" : "billing_postal_code",
          "expression" : {
            "format" : "sql",
            "expression" : "billing_postal_code"
          },
          "description" : ""
        }, {
          "target" : "billing_city",
          "expression" : {
            "format" : "sql",
            "expression" : "billing_city"
          },
          "description" : ""
        }, {
          "target" : "billing_state",
          "expression" : {
            "format" : "sql",
            "expression" : "billing_state"
          },
          "description" : ""
        }, {
          "target" : "billing_email",
          "expression" : {
            "format" : "sql",
            "expression" : "billing_email"
          },
          "description" : ""
        }, {
          "target" : "account_type",
          "expression" : {
            "format" : "sql",
            "expression" : "account_type"
          },
          "description" : ""
        }, {
          "target" : "industry",
          "expression" : {
            "format" : "sql",
            "expression" : "industry"
          },
          "description" : ""
        }, {
          "target" : "annual_revenue",
          "expression" : {
            "format" : "sql",
            "expression" : "annual_revenue"
          },
          "description" : ""
        }, {
          "target" : "number_of_employees",
          "expression" : {
            "format" : "sql",
            "expression" : "number_of_employees"
          },
          "description" : ""
        }, {
          "target" : "last_activity_date",
          "expression" : {
            "format" : "sql",
            "expression" : "last_activity_date"
          },
          "description" : ""
        }, {
          "target" : "created_date",
          "expression" : {
            "format" : "sql",
            "expression" : "created_date"
          },
          "description" : ""
        }, {
          "target" : "website",
          "expression" : {
            "format" : "sql",
            "expression" : "website"
          },
          "description" : ""
        }, {
          "target" : "lead_source",
          "expression" : {
            "format" : "sql",
            "expression" : "lead_source"
          },
          "description" : ""
        }, {
          "target" : "status",
          "expression" : {
            "format" : "sql",
            "expression" : "status"
          },
          "description" : ""
        }, {
          "target" : "rating",
          "expression" : {
            "format" : "sql",
            "expression" : "rating"
          },
          "description" : ""
        }, {
          "target" : "description",
          "expression" : {
            "format" : "sql",
            "expression" : "description"
          },
          "description" : ""
        }, {
          "target" : "last_modified_by",
          "expression" : {
            "format" : "sql",
            "expression" : "last_modified_by"
          },
          "description" : ""
        }, {
          "target" : "last_modified_date",
          "expression" : {
            "format" : "sql",
            "expression" : "last_modified_date"
          },
          "description" : ""
        }, {
          "target" : "zipcode",
          "expression" : {
            "format" : "sql",
            "expression" : "zipcode"
          },
          "description" : ""
        }, {
          "target" : "state",
          "expression" : {
            "format" : "sql",
            "expression" : "state"
          },
          "description" : ""
        }, {
          "target" : "high_income_percent",
          "expression" : {
            "format" : "sql",
            "expression" : "high_income_percent"
          },
          "description" : ""
        }, {
          "target" : "high_income_returns",
          "expression" : {
            "format" : "sql",
            "expression" : "high_income_returns"
          },
          "description" : ""
        }, {
          "target" : "low_income_returns",
          "expression" : {
            "format" : "sql",
            "expression" : "low_income_returns"
          },
          "description" : ""
        }, {
          "target" : "all_returns",
          "expression" : {
            "format" : "sql",
            "expression" : "all_returns"
          },
          "description" : ""
        }, {
          "target" : "is_high_income",
          "expression" : {
            "format" : "sql",
            "expression" : "is_high_income"
          },
          "description" : ""
        }, {
          "target" : "fullName",
          "expression" : {
            "format" : "sql",
            "expression" : "concat(first_name, ' ', last_name)"
          },
          "description" : ""
        } ],
        "importString" : "",
        "activeTab" : "expressions",
        "columnsSelector" : [ "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##account_type", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##phone", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##account_flags", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##last_activity_date", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##industry", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##billing_city", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##customer_id", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##billing_email", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##state", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##order_status", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##website", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##account_open_date", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##created_date", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##last_name", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##first_name", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##billing_address", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##email", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##account_name", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##rating", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##order_id", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##annual_revenue", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##low_income_returns", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##country_code", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##number_of_employees", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##status", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##amount", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##all_returns", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##order_date", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##billing_postal_code", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##zipcode", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##description", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##order_category", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##last_modified_date", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##is_high_income", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##last_modified_by", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##billing_state", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##high_income_returns", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##account_id", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##lead_source", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##high_income_percent", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##account_owner", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##phone_number" ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.35&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "fsJ_9X3CSLgpP8S3tpnjV$$zz_aD5JeoVF9Qo-b-MqZk" : {
      "id" : "fsJ_9X3CSLgpP8S3tpnjV$$zz_aD5JeoVF9Qo-b-MqZk",
      "component" : "Target",
      "metadata" : {
        "label" : "gold_sales_by_zip_date",
        "slug" : "gold_sales_by_zip_date",
        "x" : 620,
        "y" : 20,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "Updates or creates a table for gold sales data by zip code and date, ensuring accurate and up-to-date sales records.",
        "autoUpdateComment" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "_dKalijg_HvoC2Z7qqKIo$$Dya-jEIbEbPX7EPjObOJa",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "zipcode",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The ZIP code",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "order_date",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "total_amount",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "avg_amount",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "order_count",
              "type" : "long",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/gold_sales_by_zip_date"
      }
    },
    "tzys2o6Nv0OTQ9dD5uu_4$$l-Vfpcct6dzpSxKM9nLZL" : {
      "id" : "tzys2o6Nv0OTQ9dD5uu_4$$l-Vfpcct6dzpSxKM9nLZL",
      "component" : "Target",
      "metadata" : {
        "label" : "gold_total_sales_by_customer",
        "slug" : "gold_total_sales_by_customer",
        "x" : 620,
        "y" : 220,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "Updates or creates a table that tracks total sales by customer, ensuring accurate sales records are maintained.",
        "autoUpdateComment" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "P2VIaP0u1Ae5oSohEwgHL$$MiiW_boN0cQv80fTjZ9hj",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "customer_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "orders",
              "type" : "long",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "total_spend",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "order_date",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/gold_total_sales_by_customer"
      }
    },
    "rxaIaQR5qtYVLzRCX6G2p$$4RQ1lPzoJ4iTYxjh4cFqW" : {
      "id" : "rxaIaQR5qtYVLzRCX6G2p$$4RQ1lPzoJ4iTYxjh4cFqW",
      "component" : "Aggregate",
      "metadata" : {
        "label" : "SumAmounts",
        "slug" : "SumAmounts",
        "x" : 420,
        "y" : 220,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "Calculates total spending and order count for each customer, providing insights into customer engagement and purchasing behavior.",
        "autoUpdateComment" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "p2jAQt4FQ95GTpHzIrNZx$$s0hnqBRZkl_fO5l7h837X",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "order_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "customer_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "order_status",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Order status",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "order_category",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Order category",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "order_date",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "amount",
              "type" : "float",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "first_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer first name",
                "mappings" : [ ],
                "tags" : [ {
                  "type" : "user",
                  "name" : "pii"
                } ]
              }
            }, {
              "name" : "last_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer last name",
                "mappings" : [ ],
                "tags" : [ {
                  "type" : "user",
                  "name" : "pii"
                } ]
              }
            }, {
              "name" : "phone",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer phone number",
                "mappings" : [ ],
                "tags" : [ {
                  "type" : "user",
                  "name" : "pii"
                } ]
              }
            }, {
              "name" : "email",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer Email",
                "mappings" : [ ],
                "tags" : [ {
                  "type" : "user",
                  "name" : "pii"
                } ]
              }
            }, {
              "name" : "country_code",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer country code",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account_open_date",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account_flags",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer account flags",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Unique identifier for the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Name of the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account_owner",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The person who owns the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "phone_number",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The contact phone number associated with the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "billing_address",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Physical address for billing purposes",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "billing_postal_code",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Postal code of the billing address",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "billing_city",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "City of the billing address",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "billing_state",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The state associated with the billing address of the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "billing_email",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Email address associated with the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account_type",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The type or category of the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "industry",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The industry to which the account belongs",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "annual_revenue",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The annual revenue of the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "number_of_employees",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The number of employees associated with the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "last_activity_date",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The date of the most recent activity related to the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "created_date",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The date when the account was created",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "website",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The website associated with the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "lead_source",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The source from which the lead was generated",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "status",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The current status of the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rating",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The rating assigned to the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "description",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "A description or summary of the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "last_modified_by",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The user who last modified the account",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "last_modified_date",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The date when the account was last modified",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "zipcode",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The ZIP code",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "state",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "high_income_percent",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "high_income_returns",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "low_income_returns",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "all_returns",
              "type" : "long",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "is_high_income",
              "type" : "boolean",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "fullName",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "0IXqpqy1nhHR5pL5duLgX$$jSWzscyIu532qFaZj_pD4",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "allIns" : false,
        "doPivot" : false,
        "aggregate" : [ {
          "target" : "orders",
          "expression" : {
            "format" : "sql",
            "expression" : "count(order_id)"
          },
          "description" : "",
          "_row_id" : null
        }, {
          "target" : "total_spend",
          "expression" : {
            "format" : "sql",
            "expression" : "sum(amount)"
          },
          "description" : "",
          "_row_id" : null
        }, {
          "target" : "order_date",
          "expression" : {
            "format" : "sql",
            "expression" : "first(order_date)"
          },
          "description" : "",
          "_row_id" : null
        } ],
        "allowSelection" : true,
        "pivotColumn" : null,
        "pivotValues" : [ ],
        "activeTab" : "groupBy",
        "columnsSelector" : [ "p2jAQt4FQ95GTpHzIrNZx$$s0hnqBRZkl_fO5l7h837X##order_id", "p2jAQt4FQ95GTpHzIrNZx$$s0hnqBRZkl_fO5l7h837X##customer_id", "p2jAQt4FQ95GTpHzIrNZx$$s0hnqBRZkl_fO5l7h837X##amount", "p2jAQt4FQ95GTpHzIrNZx$$s0hnqBRZkl_fO5l7h837X##order_date" ],
        "groupBy" : [ {
          "target" : "customer_id",
          "expression" : {
            "format" : "sql",
            "expression" : "customer_id"
          },
          "description" : "",
          "_row_id" : null
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.35&projectSubscriptionProjectId=12654&path=gems/Aggregate",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "CUJmg8TC4ow2LTpkD4xTa$$_i5qUVFTMza3uMVRSyEls" : {
      "id" : "CUJmg8TC4ow2LTpkD4xTa$$_i5qUVFTMza3uMVRSyEls",
      "component" : "Source",
      "metadata" : {
        "label" : "silver_order_customer_details",
        "slug" : "silver_order_customer_details",
        "x" : 20,
        "y" : 120,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "Retrieves detailed customer order information from a designated data source.",
        "autoUpdateComment" : true
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "WRBU6jOW2-28Bu_9zVFew$$scVkcloeH0qrUHtfeM_Yz",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/silver_order_customer_details"
      }
    }
  },
  "ports" : {
    "inputs" : [ ],
    "outputs" : [ ],
    "selectedInputFields" : [ ],
    "isCustomOutputSchema" : false,
    "autoUpdateOnRun" : false
  }
}