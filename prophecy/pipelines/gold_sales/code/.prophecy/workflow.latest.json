{
  "metainfo" : {
    "migrationVersions" : {
      "gemBuilderVersion" : "v1"
    },
    "functions" : { },
    "codeGenConfiguration" : {
      "editableConfig" : false,
      "plibVersion" : {
        "mavenVersion" : "8.0.29",
        "pyPiVersion" : "1.9.9"
      }
    },
    "id" : "1",
    "uri" : "pipelines/gold_sales",
    "language" : "python",
    "fabricId" : "9664",
    "frontEndLanguage" : "sql",
    "mode" : "batch",
    "udfs" : {
      "language" : "python",
      "udfs" : [ ],
      "functionPackageName" : "scott_demo2_team.helloworld.functions",
      "sharedFunctionPackageNames" : [ "prophecy.spark_basic.functions", "prophecy.warehouse.functions" ]
    },
    "udafs" : {
      "language" : "python",
      "code" : ""
    },
    "configuration" : {
      "common" : {
        "type" : "record",
        "fields" : [ {
          "name" : "catalog_name",
          "kind" : {
            "type" : "string",
            "value" : "vlaunir_demos"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "total_by_zip_and_date",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "catalog_name",
              "kind" : {
                "type" : "string",
                "value" : "vlaunir_demos"
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : true
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        } ]
      },
      "oldCommon" : {
        "type" : "record",
        "fields" : [ ]
      },
      "fabrics" : { },
      "instances" : { },
      "selected" : "default",
      "nonEditable" : [ ],
      "isSubscribedPipelineWithPipelineConfigs" : false
    },
    "sparkConf" : [ ],
    "hadoopConf" : [ ],
    "codeMode" : "sparse",
    "buildSystem" : "maven",
    "externalDependencies" : [ ],
    "dependentProjectExternalDependencies" : [ {
      "projectUID" : "12654",
      "projectName" : "ProphecySparkBasicsPython",
      "externalDependencies" : [ ]
    }, {
      "projectUID" : "12655",
      "projectName" : "ProphecyWarehousePython",
      "externalDependencies" : [ ]
    } ],
    "isImported" : false,
    "interimMode" : "Full",
    "interimModeEnabled" : true,
    "visualCodeInterimMode" : "Disabled",
    "recordsLimit" : {
      "enabled" : false,
      "value" : 1000
    },
    "topLevelPackage" : "gold_sales",
    "configurationVersion" : "v2"
  },
  "connections" : [ {
    "id" : "wRpYbPu5",
    "source" : "k9D39na2",
    "sourcePort" : "UtTlFO7v",
    "target" : "XVKuYMJb",
    "targetPort" : "TINCuSUq"
  }, {
    "id" : "hHQnGOsu",
    "source" : "XVKuYMJb",
    "sourcePort" : "JJ16pxav",
    "target" : "CfVogM8E",
    "targetPort" : "bdNXuGKz"
  }, {
    "id" : "ETpj6gE6",
    "source" : "CUJmg8TC4ow2LTpkD4xTa$$_i5qUVFTMza3uMVRSyEls",
    "sourcePort" : "WRBU6jOW2-28Bu_9zVFew$$scVkcloeH0qrUHtfeM_Yz",
    "target" : "k9D39na2",
    "targetPort" : "ALAlcw0H"
  }, {
    "id" : "EUWSMCykGr0vL9vo9zZuQ",
    "source" : "rxaIaQR5qtYVLzRCX6G2p$$4RQ1lPzoJ4iTYxjh4cFqW",
    "sourcePort" : "0IXqpqy1nhHR5pL5duLgX$$jSWzscyIu532qFaZj_pD4",
    "target" : "tzys2o6Nv0OTQ9dD5uu_4$$l-Vfpcct6dzpSxKM9nLZL",
    "targetPort" : "P2VIaP0u1Ae5oSohEwgHL$$MiiW_boN0cQv80fTjZ9hj"
  }, {
    "id" : "m1JWOjrHzMX9k2MM0YCbB",
    "source" : "CUJmg8TC4ow2LTpkD4xTa$$_i5qUVFTMza3uMVRSyEls",
    "sourcePort" : "WRBU6jOW2-28Bu_9zVFew$$scVkcloeH0qrUHtfeM_Yz",
    "target" : "cmeh9U8XFq8QHeFmwUzw7$$7q6DXJxXUZsDqRK7-C5kX",
    "targetPort" : "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN"
  }, {
    "id" : "Ptqw_mJcKvbp90IglevXQ",
    "source" : "cmeh9U8XFq8QHeFmwUzw7$$7q6DXJxXUZsDqRK7-C5kX",
    "sourcePort" : "MXo6JurnoN6flZNUaHptp$$x5n4R4vwDuL52LdvCVnzS",
    "target" : "rxaIaQR5qtYVLzRCX6G2p$$4RQ1lPzoJ4iTYxjh4cFqW",
    "targetPort" : "p2jAQt4FQ95GTpHzIrNZx$$s0hnqBRZkl_fO5l7h837X"
  }, {
    "id" : "nCxhwJpTC4B0pdWB_MjO1",
    "source" : "cmeh9U8XFq8QHeFmwUzw7$$7q6DXJxXUZsDqRK7-C5kX",
    "sourcePort" : "MXo6JurnoN6flZNUaHptp$$x5n4R4vwDuL52LdvCVnzS",
    "target" : "Z9DnCM3QJiiiVZ6KMpUKy$$1JWV_usPlhESc2BUgo2wH",
    "targetPort" : "chTmzy0asSvb5XqDiWWu2$$3d-uPgGzJ-dKOCn_ZWJ-t"
  }, {
    "id" : "pG1mISC29VQyG4fcS0xxc",
    "source" : "Z9DnCM3QJiiiVZ6KMpUKy$$1JWV_usPlhESc2BUgo2wH",
    "sourcePort" : "wNC4UP7EW6UfJWez6Kfa-$$enRn0T7yIcJBDBFr_Ye11",
    "target" : "fsJ_9X3CSLgpP8S3tpnjV$$zz_aD5JeoVF9Qo-b-MqZk",
    "targetPort" : "_dKalijg_HvoC2Z7qqKIo$$Dya-jEIbEbPX7EPjObOJa"
  } ],
  "processes" : {
    "Z9DnCM3QJiiiVZ6KMpUKy$$1JWV_usPlhESc2BUgo2wH" : {
      "id" : "Z9DnCM3QJiiiVZ6KMpUKy$$1JWV_usPlhESc2BUgo2wH",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "total_by_zip_and_date",
        "slug" : "total_by_zip_and_date",
        "x" : 420,
        "y" : 220,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "chTmzy0asSvb5XqDiWWu2$$3d-uPgGzJ-dKOCn_ZWJ-t",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "account_age_at_order_date",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "order_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "customer_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "amount",
              "type" : "float",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "order_date",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "zipcode",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The ZIP code",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account_flags",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer account flags",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "wNC4UP7EW6UfJWez6Kfa-$$enRn0T7yIcJBDBFr_Ye11",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : { },
      "connections" : [ {
        "id" : "nNHEaRUNy89SnxMMm0u6e$$-mznfAvOIBQViCaGDLFr5",
        "source" : "L5pc-eqdwtyTELkfSP_Db$$m6L2oF5lTnjYGBbTHzBIB",
        "sourcePort" : "ulT2FJ2Fug1Okqy-6vwmE$$CbMe6Hp9gNJrv8FI3igxG",
        "target" : "CCdS0rXltkp7g_udaQXQ4$$bj3i7a-ojc2Tti2iN53pU",
        "targetPort" : "3ulCjlNOkS_alOfJhq6QI$$-Ox7j5FrMFazxlAQk04-m"
      }, {
        "id" : "_oRhzHxv1oipxqEsFPk-K$$j2w9MgCXxOTIpMQtLaRg7",
        "source" : "CCdS0rXltkp7g_udaQXQ4$$bj3i7a-ojc2Tti2iN53pU",
        "sourcePort" : "oQeYRAZFurCHPn5NOSKd8$$hwd9qy4uEmFJmeSv3HocX",
        "target" : "Z9DnCM3QJiiiVZ6KMpUKy$$1JWV_usPlhESc2BUgo2wH",
        "targetPort" : "wNC4UP7EW6UfJWez6Kfa-$$enRn0T7yIcJBDBFr_Ye11"
      }, {
        "id" : "sqt4G7LoT0zO6dzDRP9wl$$BT4ALEg86yWY6PjCiKhJi",
        "source" : "Gxwrum9VM-EG2dOyPwWgM$$Rq2sddwml2gWhTbbiBv3X",
        "sourcePort" : "gvMFQmrN7JhQ-GiK3bxCW$$lfd5hs8C-fuUGdC2-WMCP",
        "target" : "L5pc-eqdwtyTELkfSP_Db$$m6L2oF5lTnjYGBbTHzBIB",
        "targetPort" : "97RXLmrAv6ye9XZENUZEq$$9VT2PijShjMNNlvt-3uOx"
      }, {
        "id" : "jAYYLI14tL3SvOYnRhJfZ",
        "source" : "Z9DnCM3QJiiiVZ6KMpUKy$$1JWV_usPlhESc2BUgo2wH",
        "sourcePort" : "chTmzy0asSvb5XqDiWWu2$$3d-uPgGzJ-dKOCn_ZWJ-t",
        "target" : "Gxwrum9VM-EG2dOyPwWgM$$Rq2sddwml2gWhTbbiBv3X",
        "targetPort" : "75gKWW7EOU4wBcSrTcv8N$$QvA2VlpyK-0rKmx_hv__c"
      } ],
      "processes" : {
        "L5pc-eqdwtyTELkfSP_Db$$m6L2oF5lTnjYGBbTHzBIB" : {
          "id" : "L5pc-eqdwtyTELkfSP_Db$$m6L2oF5lTnjYGBbTHzBIB",
          "component" : "Aggregate",
          "metadata" : {
            "label" : "TotalByZipCodeAndDate",
            "slug" : "TotalByZipCodeAndDate",
            "x" : 820,
            "y" : 320,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "97RXLmrAv6ye9XZENUZEq$$9VT2PijShjMNNlvt-3uOx",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "account_age_at_order_date",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "order_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customer_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "amount",
                  "type" : "float",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "order_date",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "zipcode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The ZIP code",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "account_flags",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Customer account flags",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "ulT2FJ2Fug1Okqy-6vwmE$$CbMe6Hp9gNJrv8FI3igxG",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "allIns" : false,
            "doPivot" : false,
            "aggregate" : [ {
              "target" : "total_amount",
              "expression" : {
                "format" : "sql",
                "expression" : "sum(amount)"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "avg_amount",
              "expression" : {
                "format" : "sql",
                "expression" : "avg(amount)"
              },
              "description" : "",
              "_row_id" : "c_1508"
            }, {
              "target" : "order_count",
              "expression" : {
                "format" : "sql",
                "expression" : "count(order_id)"
              },
              "description" : "",
              "_row_id" : "c_1555"
            } ],
            "allowSelection" : true,
            "pivotColumn" : null,
            "pivotValues" : [ ],
            "activeTab" : "groupBy",
            "columnsSelector" : [ "97RXLmrAv6ye9XZENUZEq$$9VT2PijShjMNNlvt-3uOx##zipcode", "97RXLmrAv6ye9XZENUZEq$$9VT2PijShjMNNlvt-3uOx##amount", "97RXLmrAv6ye9XZENUZEq$$9VT2PijShjMNNlvt-3uOx##order_date", "97RXLmrAv6ye9XZENUZEq$$9VT2PijShjMNNlvt-3uOx##order_id" ],
            "groupBy" : [ {
              "target" : "zipcode",
              "expression" : {
                "format" : "sql",
                "expression" : "zipcode"
              },
              "description" : "",
              "_row_id" : null
            }, {
              "target" : "order_date",
              "expression" : {
                "format" : "sql",
                "expression" : "order_date"
              },
              "description" : "",
              "_row_id" : null
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Aggregate",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "CCdS0rXltkp7g_udaQXQ4$$bj3i7a-ojc2Tti2iN53pU" : {
          "id" : "CCdS0rXltkp7g_udaQXQ4$$bj3i7a-ojc2Tti2iN53pU",
          "component" : "OrderBy",
          "metadata" : {
            "label" : "SortByDateAndZip",
            "slug" : "SortByDateAndZip",
            "x" : 1000,
            "y" : 320,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "3ulCjlNOkS_alOfJhq6QI$$-Ox7j5FrMFazxlAQk04-m",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "zipcode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The ZIP code",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "order_date",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "total_amount",
                  "type" : "double",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "avg_amount",
                  "type" : "double",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "order_count",
                  "type" : "long",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "oQeYRAZFurCHPn5NOSKd8$$hwd9qy4uEmFJmeSv3HocX",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ "3ulCjlNOkS_alOfJhq6QI$$-Ox7j5FrMFazxlAQk04-m##order_date", "3ulCjlNOkS_alOfJhq6QI$$-Ox7j5FrMFazxlAQk04-m##zipcode" ],
            "orders" : [ {
              "expression" : {
                "format" : "sql",
                "expression" : "order_date"
              },
              "sortType" : "asc"
            }, {
              "expression" : {
                "format" : "sql",
                "expression" : "zipcode"
              },
              "sortType" : "asc"
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/OrderBy",
            "projectName" : "ProphecySparkBasicsPython"
          }
        },
        "Gxwrum9VM-EG2dOyPwWgM$$Rq2sddwml2gWhTbbiBv3X" : {
          "id" : "Gxwrum9VM-EG2dOyPwWgM$$Rq2sddwml2gWhTbbiBv3X",
          "component" : "Deduplicate",
          "metadata" : {
            "label" : "deduplicate_by_order_id_zipcode_order_date_amount",
            "slug" : "deduplicate_by_order_id_zipcode_order_date_amount",
            "x" : 640,
            "y" : 320,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "comment" : "Removes duplicate records based on order ID, zipcode, order date, and amount.",
            "autoUpdateComment" : true
          },
          "ports" : {
            "inputs" : [ {
              "id" : "75gKWW7EOU4wBcSrTcv8N$$QvA2VlpyK-0rKmx_hv__c",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "account_age_at_order_date",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "order_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "customer_id",
                  "type" : "integer",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "amount",
                  "type" : "float",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "order_date",
                  "type" : "date",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "zipcode",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "The ZIP code",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "account_flags",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "Customer account flags",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "gvMFQmrN7JhQ-GiK3bxCW$$lfd5hs8C-fuUGdC2-WMCP",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "dedupColumns" : [ {
              "colName" : "order_id"
            }, {
              "colName" : "zipcode"
            }, {
              "colName" : "order_date"
            }, {
              "colName" : "amount"
            } ],
            "dedupType" : "any",
            "columnsSelector" : [ "75gKWW7EOU4wBcSrTcv8N$$QvA2VlpyK-0rKmx_hv__c##zipcode", "75gKWW7EOU4wBcSrTcv8N$$QvA2VlpyK-0rKmx_hv__c##order_date", "75gKWW7EOU4wBcSrTcv8N$$QvA2VlpyK-0rKmx_hv__c##amount", "75gKWW7EOU4wBcSrTcv8N$$QvA2VlpyK-0rKmx_hv__c##order_id" ],
            "orders" : [ ],
            "useOrderBy" : false
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Deduplicate",
            "projectName" : "ProphecySparkBasicsPython"
          }
        }
      }
    },
    "cmeh9U8XFq8QHeFmwUzw7$$7q6DXJxXUZsDqRK7-C5kX" : {
      "id" : "cmeh9U8XFq8QHeFmwUzw7$$7q6DXJxXUZsDqRK7-C5kX",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Cleanup",
        "slug" : "Cleanup",
        "x" : 220,
        "y" : 120,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "order_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "order_date",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "amount",
              "type" : "float",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "customer_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account_open_date",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "first_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer first name",
                "mappings" : [ ],
                "tags" : [ {
                  "type" : "user",
                  "name" : "pii"
                } ]
              }
            }, {
              "name" : "last_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer last name",
                "mappings" : [ ],
                "tags" : [ {
                  "type" : "user",
                  "name" : "pii"
                } ]
              }
            }, {
              "name" : "zipcode",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The ZIP code",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account_flags",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer account flags",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "MXo6JurnoN6flZNUaHptp$$x5n4R4vwDuL52LdvCVnzS",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "importLanguage" : "python",
        "expressions" : [ {
          "target" : "account_age_at_order_date",
          "expression" : {
            "format" : "sql",
            "expression" : "datediff(account_open_date, order_date)"
          },
          "description" : ""
        }, {
          "target" : "order_id",
          "expression" : {
            "format" : "sql",
            "expression" : "order_id"
          },
          "description" : ""
        }, {
          "target" : "customer_id",
          "expression" : {
            "format" : "sql",
            "expression" : "customer_id"
          },
          "description" : ""
        }, {
          "target" : "amount",
          "expression" : {
            "format" : "sql",
            "expression" : "amount"
          },
          "description" : ""
        }, {
          "target" : "order_date",
          "expression" : {
            "format" : "sql",
            "expression" : "order_date"
          },
          "description" : ""
        }, {
          "target" : "zipcode",
          "expression" : {
            "format" : "sql",
            "expression" : "zipcode"
          },
          "description" : ""
        }, {
          "target" : "account_flags",
          "expression" : {
            "format" : "sql",
            "expression" : "account_flags"
          },
          "description" : ""
        } ],
        "importString" : "",
        "activeTab" : "expressions",
        "columnsSelector" : [ "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##account_flags", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##account_open_date", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##order_id", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##order_date", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##amount", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##zipcode", "7Sl1POjLs_iThUKfZHrKm$$YnFjYVPWqnHtkKkI5URlN##customer_id" ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "k9D39na2" : {
      "id" : "k9D39na2",
      "component" : "Aggregate",
      "metadata" : {
        "label" : "customer_order_total",
        "slug" : "customer_order_total",
        "x" : 220,
        "y" : 420,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "ALAlcw0H",
          "slug" : "silver_order_customer_details",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "order_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "order_date",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "amount",
              "type" : "float",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "customer_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account_open_date",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "first_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer first name",
                "mappings" : [ ],
                "tags" : [ {
                  "type" : "user",
                  "name" : "pii"
                } ]
              }
            }, {
              "name" : "last_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer last name",
                "mappings" : [ ],
                "tags" : [ {
                  "type" : "user",
                  "name" : "pii"
                } ]
              }
            }, {
              "name" : "zipcode",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The ZIP code",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account_flags",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer account flags",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "UtTlFO7v",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "allIns" : false,
        "doPivot" : false,
        "aggregate" : [ {
          "target" : "TOTAL_AMOUNT",
          "expression" : {
            "format" : "sql",
            "expression" : "SUM(amount)"
          },
          "description" : ""
        } ],
        "allowSelection" : true,
        "pivotColumn" : null,
        "pivotValues" : [ ],
        "activeTab" : "aggregate",
        "columnsSelector" : [ ],
        "groupBy" : [ {
          "target" : "customer_id",
          "expression" : {
            "format" : "sql",
            "expression" : "customer_id"
          },
          "description" : ""
        }, {
          "target" : "first_name",
          "expression" : {
            "format" : "sql",
            "expression" : "first_name"
          },
          "description" : ""
        }, {
          "target" : "last_name",
          "expression" : {
            "format" : "sql",
            "expression" : "last_name"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Aggregate",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "fsJ_9X3CSLgpP8S3tpnjV$$zz_aD5JeoVF9Qo-b-MqZk" : {
      "id" : "fsJ_9X3CSLgpP8S3tpnjV$$zz_aD5JeoVF9Qo-b-MqZk",
      "component" : "Target",
      "metadata" : {
        "label" : "gold_sales_by_zip_date",
        "slug" : "gold_sales_by_zip_date",
        "x" : 620,
        "y" : 220,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "_dKalijg_HvoC2Z7qqKIo$$Dya-jEIbEbPX7EPjObOJa",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "zipcode",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The ZIP code",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "order_date",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "total_amount",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "avg_amount",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "order_count",
              "type" : "long",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/gold_sales_by_zip_date"
      }
    },
    "XVKuYMJb" : {
      "id" : "XVKuYMJb",
      "component" : "OrderBy",
      "metadata" : {
        "label" : "order_by_total_amount_desc_nulls_first",
        "slug" : "order_by_total_amount_desc_nulls_first",
        "x" : 420,
        "y" : 420,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "TINCuSUq",
          "slug" : "customer_order_total",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "customer_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "first_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer first name",
                "mappings" : [ ],
                "tags" : [ {
                  "type" : "user",
                  "name" : "pii"
                } ]
              }
            }, {
              "name" : "last_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer last name",
                "mappings" : [ ],
                "tags" : [ {
                  "type" : "user",
                  "name" : "pii"
                } ]
              }
            }, {
              "name" : "TOTAL_AMOUNT",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "JJ16pxav",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "orders" : [ {
          "expression" : {
            "format" : "sql",
            "expression" : "TOTAL_AMOUNT"
          },
          "sortType" : "desc"
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/OrderBy",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "tzys2o6Nv0OTQ9dD5uu_4$$l-Vfpcct6dzpSxKM9nLZL" : {
      "id" : "tzys2o6Nv0OTQ9dD5uu_4$$l-Vfpcct6dzpSxKM9nLZL",
      "component" : "Target",
      "metadata" : {
        "label" : "gold_total_sales_by_customer",
        "slug" : "gold_total_sales_by_customer",
        "x" : 620,
        "y" : 20,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "P2VIaP0u1Ae5oSohEwgHL$$MiiW_boN0cQv80fTjZ9hj",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "customer_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "orders",
              "type" : "long",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "total_spend",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/gold_total_sales_by_customer"
      }
    },
    "rxaIaQR5qtYVLzRCX6G2p$$4RQ1lPzoJ4iTYxjh4cFqW" : {
      "id" : "rxaIaQR5qtYVLzRCX6G2p$$4RQ1lPzoJ4iTYxjh4cFqW",
      "component" : "Aggregate",
      "metadata" : {
        "label" : "SumAmounts",
        "slug" : "SumAmounts",
        "x" : 420,
        "y" : 20,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "p2jAQt4FQ95GTpHzIrNZx$$s0hnqBRZkl_fO5l7h837X",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "account_age_at_order_date",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "order_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "customer_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "amount",
              "type" : "float",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "order_date",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "zipcode",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The ZIP code",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account_flags",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer account flags",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "0IXqpqy1nhHR5pL5duLgX$$jSWzscyIu532qFaZj_pD4",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "allIns" : false,
        "doPivot" : false,
        "aggregate" : [ {
          "target" : "orders",
          "expression" : {
            "format" : "sql",
            "expression" : "count(order_id)"
          },
          "description" : "",
          "_row_id" : null
        }, {
          "target" : "total_spend",
          "expression" : {
            "format" : "sql",
            "expression" : "sum(amount)"
          },
          "description" : "",
          "_row_id" : null
        } ],
        "allowSelection" : true,
        "pivotColumn" : null,
        "pivotValues" : [ ],
        "activeTab" : "aggregate",
        "columnsSelector" : [ "p2jAQt4FQ95GTpHzIrNZx$$s0hnqBRZkl_fO5l7h837X##order_id", "p2jAQt4FQ95GTpHzIrNZx$$s0hnqBRZkl_fO5l7h837X##customer_id", "p2jAQt4FQ95GTpHzIrNZx$$s0hnqBRZkl_fO5l7h837X##amount" ],
        "groupBy" : [ {
          "target" : "customer_id",
          "expression" : {
            "format" : "sql",
            "expression" : "customer_id"
          },
          "description" : "",
          "_row_id" : null
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Aggregate",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "CfVogM8E" : {
      "id" : "CfVogM8E",
      "component" : "Limit",
      "metadata" : {
        "label" : "limit_10",
        "slug" : "limit_10",
        "x" : 620,
        "y" : 420,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "bdNXuGKz",
          "slug" : "order_by_total_amount_desc_nulls_first",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "customer_id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "first_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer first name",
                "mappings" : [ ],
                "tags" : [ {
                  "type" : "user",
                  "name" : "pii"
                } ]
              }
            }, {
              "name" : "last_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Customer last name",
                "mappings" : [ ],
                "tags" : [ {
                  "type" : "user",
                  "name" : "pii"
                } ]
              }
            }, {
              "name" : "TOTAL_AMOUNT",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Z2zviJL8",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "limit" : "10"
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Limit",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "CUJmg8TC4ow2LTpkD4xTa$$_i5qUVFTMza3uMVRSyEls" : {
      "id" : "CUJmg8TC4ow2LTpkD4xTa$$_i5qUVFTMza3uMVRSyEls",
      "component" : "Source",
      "metadata" : {
        "label" : "silver_order_customer_details",
        "slug" : "silver_order_customer_details",
        "x" : 20,
        "y" : 220,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "WRBU6jOW2-28Bu_9zVFew$$scVkcloeH0qrUHtfeM_Yz",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/silver_order_customer_details"
      }
    }
  },
  "ports" : {
    "inputs" : [ ],
    "outputs" : [ ],
    "selectedInputFields" : [ ],
    "isCustomOutputSchema" : false,
    "autoUpdateOnRun" : false
  }
}